pipeline {
        agent {
            docker { image 'python:3.8' }
        }
         stages {
            stage('Build') {
                steps {
                         
                        withEnv(["HOME=${env.WORKSPACE}"]){
                                sh 'python3 -m pip install --upgrade pip setuptools wheel'
                                sh 'pip3 install -r SecureCity/requirements.txt'
                                sh 'pip3 install django-crispy-forms'
                                sh 'pip3 install coverage'
                                sh 'pip3 install django-jenkins'
                                sh 'pip3 uninstall auditlog'
                                sh 'pip3 install auditlog3'
                        } 
                }
                
            }
            stage('Test') {
                steps {
                        withEnv(["HOME=${env.WORKSPACE}"]){
                                sh 'python SecureCity/manage.py jenkins'
                        }
                }
            }
        }
       
    }
